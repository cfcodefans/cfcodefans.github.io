(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[462],{8701:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/tech/web/backend/nginx-portal-setup",function(){return t(407)}])},407:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return i}});t(7667);var s=t(3905);function a(e,n){if(null==e)return{};var t,s,a=function(e,n){if(null==e)return{};var t,s,a={},l=Object.keys(e);for(s=0;s<l.length;s++)t=l[s],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(s=0;s<l.length;s++)t=l[s],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var l={};function i(e){var n=e.components,t=a(e,["components"]);return(0,s.kt)("wrapper",Object.assign({},l,t,{components:n,mdxType:"MDXLayout"}),(0,s.kt)("div",{className:"text-center"},(0,s.kt)("p",null,(0,s.kt)("img",Object.assign({parentName:"p"},{src:"/assets/res/backend/nginx.png",alt:"NGINX",height:"100"})))),(0,s.kt)("p",null,"A note from my study about how to setup and use nginx to work as proxy,  so that we could\nbypass ",(0,s.kt)("a",Object.assign({parentName:"p"},{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS"}),"cors")," limitation to fetch data (disclaimer!)."),(0,s.kt)("h1",null,"Installation"),(0,s.kt)("p",null,"Here I use centos system, so according to ",(0,s.kt)("a",Object.assign({parentName:"p"},{href:"https://www.nginx.com/resources/wiki/start/topics/tutorials/install/"}),"nginx offical document"),"\nFirstly it needs to add nginx yum repo by creation of file at ",(0,s.kt)("strong",{parentName:"p"},"/etc/yum.repos.d/nginx.repo")),(0,s.kt)("pre",null,(0,s.kt)("code",Object.assign({parentName:"pre"},{className:"hljs language-bash"}),(0,s.kt)("span",Object.assign({parentName:"code"},{className:"hljs-comment"}),"# cat /etc/yum.repos.d/nginx.repo"),"\n[nginx]\nname=nginx repo\nbaseurl=https://nginx.org/packages/centos/8/x86_64/\ngpgcheck=0\nenabled=1")),(0,s.kt)("p",null,"I was not sure about the version of the server, then found a command that could show some system info"),(0,s.kt)("pre",null,(0,s.kt)("code",Object.assign({parentName:"pre"},{className:"hljs language-bash"}),(0,s.kt)("span",Object.assign({parentName:"code"},{className:"hljs-comment"}),"# hostnamectl"),"\n.....\n  Operating System: CentOS Linux 8\n       CPE OS Name: cpe:/o:centos:centos:8\n            Kernel: Linux 4.18.0-240.1.1.el8_3.x86_64\n      Architecture: x86-64")),(0,s.kt)("p",null,'Therefore, the repo path should be "nginx.org/packages/centos/',(0,s.kt)("strong",{parentName:"p"},"8/x86_64"),'/"'),(0,s.kt)("p",null,'continue with "yum install nginx"'),(0,s.kt)("p",null,"After installation finished, we could check if ",(0,s.kt)("a",Object.assign({parentName:"p"},{href:"https://wiki.archlinux.org/index.php/systemd#Basic_systemctl_usage"}),"systemd")," is setup"),(0,s.kt)("pre",null,(0,s.kt)("code",Object.assign({parentName:"pre"},{className:"hljs language-bash"}),(0,s.kt)("span",Object.assign({parentName:"code"},{className:"hljs-comment"}),"# systemctl status nginx"),"\n\u25cf nginx.service - The nginx HTTP and reverse proxy server\n   Loaded: loaded (/usr/lib/systemd/system/nginx.service; disabled; vendor preset: disabled)\n   Active: inactive (dead)\n\n.... nginx.service: Unit cannot be reloaded because it is inactive.")),(0,s.kt)("h1",null,"Configuration"),(0,s.kt)("p",null,'somewhere in /etc/nginx/nginx.conf, is a directive that includes "sites-enabled"\n',(0,s.kt)("inlineCode",{parentName:"p"},"include /etc/nginx/sites-enabled/*;"),"\nTherefore I could just place my nginx configs in site-enabled folder"),(0,s.kt)("h3",null,"gzip"),(0,s.kt)("pre",null,(0,s.kt)("code",Object.assign({parentName:"pre"},{}),"gzip off;\ngzip_http_version 1.1;\ngzip_comp_level 2;\ngzip_types text/plain application/javascript application/x-javascript text/css application/xml text/javascript;\n")),(0,s.kt)("h1",null,"HTTPS"),(0,s.kt)("pre",null,(0,s.kt)("code",Object.assign({parentName:"pre"},{}),"")),(0,s.kt)("h1",null,"Install ",(0,s.kt)("a",Object.assign({parentName:"h1"},{href:"https://github.com/chobits/ngx_http_proxy_connect_module#install"}),"ngx_http_proxy_connect_module")," for forward http proxy"),(0,s.kt)("p",null,"Firstly, I have to install some dependencies used by nginx compilation"),(0,s.kt)("pre",null,(0,s.kt)("code",Object.assign({parentName:"pre"},{className:"hljs language-bash"}),(0,s.kt)("span",Object.assign({parentName:"code"},{className:"hljs-comment"}),"#install regular expression lib"),"\napt-get install libpcre3 libpcre3-dev  \n",(0,s.kt)("span",Object.assign({parentName:"code"},{className:"hljs-comment"}),"#install zlib to support compression"),"\napt-get install zlib1g-dev\n",(0,s.kt)("span",Object.assign({parentName:"code"},{className:"hljs-comment"}),"#install open-ssl"),"\napt-get install openssl libssl-dev")),(0,s.kt)("h1",null,"Check NGINX installed modules"),(0,s.kt)("pre",null,(0,s.kt)("code",Object.assign({parentName:"pre"},{className:"hljs language-bash"}),"nginx -V 2>&1 | tr ",(0,s.kt)("span",Object.assign({parentName:"code"},{className:"hljs-string"}),"' '")," ",(0,s.kt)("span",Object.assign({parentName:"code"},{className:"hljs-string"}),"'\\n'"))))}i.isMDXComponent=!0}},function(e){e.O(0,[774,888,179],(function(){return n=8701,e(e.s=n);var n}));var n=e.O();_N_E=n}]);